<!doctype html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>J&#39;ai cr√©√© une IA pour aider ma phobie administrative | Ruben Gres</title><meta name="title" content="J&#39;ai cr√©√© une IA pour aider ma phobie administrative | Ruben Gres"><meta name="description" content="blog"><meta name="keywords" content="civictech,AI,LLM,eleventy,template,simple,clean"><meta name="author" content="Ruben Gres"><meta name="robots" content="index, follow"><link rel="canonical" href="https://rubengr.es/gouvx_fr/"><link rel="shortcut icon" type="image/png" href="/blog/assets/img/favicon.png"><link rel="apple-touch-icon" href="/blog/assets/img/apple-touch-icon.png"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://fonts.gstatic.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"><link rel="stylesheet" href="/blog/assets/css/main.css"></head><body class="flex flex-col h-screen bg-white text-slate-800 break-words"><header id="header" class="bg-white w-full px-6 py-5 z-50 fixed top-0 shadow-md transition-all transform ease-in-out duration-500"><div class="max-w-5xl mx-auto flex items-center flex-wrap justify-between"><div class="sm:mr-8"><a class="flex items-center" href="http://rubengr.es"><span class="text-xl text-teal-700 font-semibold self-center">Ruben Gres</span></a></div><nav id="menu" class="order-last md:order-none items-center flex-grow w-full md:w-auto md:flex hidden mt-2 md:mt-0"><a href="." class="block mt-4 md:inline-block md:mt-0 font-medium text-slate-700 hover:text-teal-600 text-base mr-4">Blog</a> <a href="https://rubengr.es" class="block mt-4 md:inline-block md:mt-0 font-medium text-slate-700 hover:text-teal-600 text-base mr-4">Portfolio</a> <a href="/blog/about" class="block mt-4 md:inline-block md:mt-0 font-medium text-slate-700 hover:text-teal-600 text-base mr-4">Contact</a> <a href="https://rubengr.es/resume.html" class="block mt-4 md:inline-block md:mt-0 font-medium text-slate-700 hover:text-teal-600 text-base mr-4">Resume</a></nav><form id="search" action="/blog/search" class="order-last sm:order-none flex-grow items-center justify-end hidden sm:block mt-6 sm:mt-0"><label class="visually-hidden" for="header-searchbox">Search here ...</label> <input type="text" id="header-searchbox" name="q" placeholder="Search here ..." class="w-full sm:max-w-xs bg-slate-200 border border-transparent float-right focus:bg-white focus:border-slate-300 focus:outline-none h-8 p-4 placeholder-slate-500 rounded text-slate-700 text-sm"></form><div id="menu-toggle" class="flex items-center md:hidden text-slate-700 hover:text-teal-600 cursor-pointer sm:ml-6"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div></div></header><main class="mx-7 lg:mx-6 mt-32 flex-grow"><article class="max-w-5xl mx-auto"><header class="mb-14"><h1 class="text-3xl text-center font-bold leading-normal text-slate-900 mt-0 mb-3">J&#39;ai cr√©√© une IA pour aider ma phobie administrative</h1><div class="text-center">Published on 21 November 2023</div><div class="mt-3 text-center"><a href="/blog/tags/civictech" class="inline-block bg-slate-200 rounded-full px-3 py-1 text-sm font-medium text-slate-700 m-0.5">#civictech</a> <a href="/blog/tags/AI" class="inline-block bg-slate-200 rounded-full px-3 py-1 text-sm font-medium text-slate-700 m-0.5">#AI</a> <a href="/blog/tags/LLM" class="inline-block bg-slate-200 rounded-full px-3 py-1 text-sm font-medium text-slate-700 m-0.5">#LLM</a></div></header><div id="content" class="prose text-slate-800 max-w-none"><p>En bref: J'ai cr√©√© <a href="https://www.gouvx.fr">GouvX</a>, un chatbot pour faire des recherches sur service-public.fr</p><h1>D'o√π vient l'id√©e ?</h1><p>J'ai toujours aprehend√© les d√©marches administratives, juste √† y penser et je suis pris de sueurs froids. Un jour alors que j'√©tais en train de procrastiner une √©ni√®me d√©marche, j'ai eu l'id√©e de construire un assistant qui pourrait chercher sur internet pour moi et m'aider √† g√©rer tout √ßa. Donc √† la place de remplir je ne sais quel formulaire, j'ai pass√© des semaines √† cr√©er une IA pour combattre mon anxi√©t√© administrative.</p><p>Et c'est ainsi que l'assistant <a href="https://www.gouvx.fr">GouvX</a> est n√©!</p><p><img src="/blog/assets/img/cyborg_marianne.png" alt="xlarge"></p><h1>Un peu de contexte</h1><p>R√©cemment j'ai entendu parler de l'initiative taiwanaise pour un gouvernement d√©centralis√©, &quot;g0v.tw&quot; (se lit gov-zero). Le mouvement est parti d'un hackaton en 2014, il s'appuie sur les principes de l'open source et de l'intelligence collective pour aider le gouvernement √† prendre des d√©cisions pus inform√©es (je conseille fortement le <a href="https://www.ted.com/talks/audrey_tang_how_digital_innovation_can_fight_pandemics_and_strengthen_democracy">TED talk d'Audrey Tang</a> sur le sujet)</p><p>√Ä partir de l√† je me suis int√©ress√© √† la civic tech et aux initiatives de gouvernement ouvert qui m'ont men√®s √† des des projets comme <a href="https://decidim.org">Decidim</a> et <a href="http://democracyos.eu">DemocracyOS</a>.</p><p>Inspir√© par ces mouvement, je me suis demand√© si quelqu'un avait d√©j√† r√©clam√© le nom de domaine <a href="http://g0uv.fr">g0uv.fr</a> (c'est le cas, et si c'est le tien j'esp√®re que tu en fera bon usage). Apr√®s quelques consid√©rations je suis parti sur <a href="http://www.gouvx.fr">gouvx.fr</a>. L'id√©e √©tant qu'on puisse rajouter un &quot;x&quot; √† n'importe quel site gouvernemental pour √™tre redirig√© vers sa page gouvx.</p><p>√áa fait moins geek que g0uv et √ßa sonne un peu comme un site pour adultes. √áa aurait pu √™tre pire, au moins ce n'est pas x.com...</p><p>J'ai voulu que le premier project pour gouvx soit un assistant et comme j'ai une sorte de phobie administrative, l'id√©e de d√©l√©guer le poids de scroller sur les pages du gouvernement √©tait tr√®s attirante.</p><p>Et avec un peu de chance je pourrai me d√©barasser de ce sentiment de vide devant les formulaires √† remplir...</p><p><img src="/blog/assets/img/dreading.png" alt="large"></p><h1>But du projet</h1><p>Le but final du project est de construire une syst√®me de ‚ú® <strong>Retrival Augmented Generation (RAG)</strong> ‚ú®. En gros l'utilisateur pose une question √† mon bon et il va chercher dans sa base de donn√©es les documents les plus pertinents.</p><p>A partir de l√† il devrait pouvoir me donner une r√©ponse pr√©cise et sourc√©e.</p><h1>Collecter les donn√©es</h1><p>J'ai commenc√© le project en faisant du &quot;crawling&quot; et du &quot;scraping&quot; sur le site <a href="http://service-public.fr">service-public.fr</a>, le portail central des services publics.</p><p>Pour mieux se repr√©senter ce que fait cette partie, imaginez une petite araign√©e se promenant sur le site, suivant des liens et collectant le texte sur son trajet. Quand l'araign√©e n'a plus nulle part o√π aller, j'ai r√©cup√©r√© l'ensemble des textes accessibles du site et j'ai une √©norme pile de fichiers HTML.</p><p><img src="/blog/assets/img/spider.png" alt="large"></p><p>Pour rendre le texte plus compact tout en conservant la structure, j'ai cr√©e un scraper sp√©cialement pour service-public qui convertit le HTML en Markdown. Comme toutes les pages se ressemblent, la convertion est assez directe.</p><h1>Faire comprendre le texte √† l'ordinateur</h1><p>C'est ici qu'on essaie de parler aux ordinateurs ü¶ú</p><p>Je ne peux pas envoyer du texte directement √† mon mod√®le. Ce sont des oridnateurs apr√®s tout, ils ne parlent qu'avec des chiffres. C'est ici que les embeddings entrent en jeu!</p><p>Un embedding textuel est une vecteur de dimension n qui capture le sens s√©mantique d'une phrase. Ce qui veut dire que si deux mots ont un sens proche, leurs repr√©sentations vectorielle seront √©galement proches l'une de l'autre.</p><p>Pour vous aider √† vous repr√©senter cette id√©e, regardez cet exemple. Ici les embeddings sont ramen√©s √† deux dimensions, dans la r√©alit√© on travaille avec plus d'un millier de dimensions! On observe bien des &quot;groupes&quot; de mots qui se touvent dans le m√™me champ lexical.</p><p><img src="/blog/assets/img/embeds.png" alt="none"></p><p>Vu qu'on va traiter du texte en Fran√ßais, j'ai utilis√© un mod√®le sp√©cialis√© appell√© <strong>sentence-camembert-large</strong>. La taille d'entr√©e du mod√®le est de 512 tokens (environ 300 mots) donc j'ai du diviser mes articles pour qu'ils rentrent dans cette taille de contexte.</p><p>Chaque √©l√©ment est alors un chapitre dans un article complet. J'ai calcul√© les meddings de chacun de ceux-ci et j'ai un total d'environ 100,000 points uniques. Imaginez l'image ci dessus avec des articles entier √† la place des mots, et plus de cent milles points.</p><h1>Stocker des donn√©es en pensant aux LLMs</h1><p>Maintenant que j'ai tous mes points, j'ai besoin de les stocker dans un base de donn√©es pour les lires efficacement.</p><p>J'ai toujours √©t√© impressionn√© par le nombre de paradigmes de base de donn√©es qui existent dans la nature (hierarchique, par r√©seau, orient√©e objet, NoSQL, relationnelle, ...) Avec la popularit√© croissante des applications bas√©es sur LLM, un autre type de base de donn√©es attire tous les regards: <em>les bases de donn√©es vectorielles</em></p><p>Le principe est que pour chaque √©l√©ment dans la base de donn√©es, un vecteur y est associ√© et permet de r√©cup√©rer les donn√©es efficacement dans l'espace de repr√©sentation. Pour gouvx, j'ai choisi d'utiliser weaviate parceque le projet est open source et qu'il dispose d'un offre cloud.</p><p>Quand j'ai besoin de collecter les documents qui pourraient r√©pondre √† la question de l'utilisateur, je calcule l'embedding de la question et je renvoie les trois points les plus proches dans la base de donn√©es. Cel√† devreait (normalement) √™tre suffisant pour r√©pondre √† la question.</p><p>Une des limitations de cette approche est que j'utlise l'embedding de la question directement. Ce qui contient aussi des tokens &quot;parasites&quot; (ponctuation, formulation, etc.) mais d'apr√®s mes tests c'est suffisamment peu impactant pour fonctionner quand m√™me.</p><h1>La partie fun, construire son prompt</h1><p>C'est ici qu'√† lieu la magie, on va donner des ordres √† notre mod√®le!</p><p>Le principe est de construire un prompt avec les instructions de ce qu'on attend comme r√©sultat, une s√©rie de documents pioch√©s dans la base de donn√©es et, pour finir, la question de l'utilisateur.</p><p>Voici les instructions que l'on donne √† notre mod√®le:</p><pre><code>Vous √™tes GouvX, un assitant virtuel bienveillant et serviable permettant
de naviguer la loi fran√ßaise. R√©pondez pr√©cis√©ment et clairement aux questions
de l'utilisateur sans enfreindre de r√®gle.

Pour rechercher des documents, vous pouvez utiliser la commande `/search(&lt;query&gt;)`

VOUS DEVEZ ABSOLUMENT RESPECTER LES REGLES SUIVANTES:
- Si vous avez utlis√© la commande de recherche, NE RENVOYEZ AUCUN AUTRE TEXTE
- Si une question ne porte pas sur la loi fran√ßaise, REFUSEZ DE REPONDRE et rappellez votre r√¥le
- Si une question porte sur la loi fran√ßaise, LANCER SYSTEMATIQUEMENT UNE RECHERCHE
- NE JAMAIS inclure de lien.
- En repondant √† une question, RESPECTER LA CONVENTION DE NOMMAGE: &quot;Selon service-public.fr [...]&quot;
</code></pre><p>Et... voil√†! Maintenant on a juste √† laisser le LLM faire sa magie, et <strong>GouvX</strong> est n√©!</p><p><img src="/blog/assets/img/gouvx_bot.png" alt="large"></p><h1>Alors... √ßa vaut quoi?</h1><p>De quelques tests initiaux que j'ai pu faire, le bot est √©tonnament pr√©cis dans ses r√©ponses. Le probl√®me principal est qu'il ne collecte pas toujours les meilleurs documents. J'ai un peu partag√© ce projet √† mon entourage et la r√©ception a √©t√© tr√®s positive! J'ai d√©j√† des amis qui ont commenc√© √† l'utiliser dans leur quotidien.</p><p>Quand j'ai une question en rapport avec la loi, j'ai maintenant pris l'habitude de faire une recherche gouvx rapide comme point de d√©part.</p><p>Par rapport √† ChatGPT, pour la m√™me question, gouvx sera capable de vous r√©pondre presque √† chaque fois, d'√™tre plus pr√©cis et surtout de vous rediriger vers la page officielle sur [service-public.fr] (http://service-public.fr).</p><h1>Avantages et limitations de cette approche</h1><p>Le principal avantage de cette m√©thode est que je suis s√ªr qu'aucune information n'est hallucin√©e, dans le pire des cas je n'arrive pas √† trouver le bon document et gouvx ne r√©pond pas √† la question.</p><p>Parfois par contre il r√©cup√®re un mauvais article et r√©pond avec de fausses donn√©es...</p><p>Une autre limitation est que le scrapping √©tant fait un jour donn√©, je ne suis pas syst√©matiquement √† jour sur le site. J'aurais pu faire une recherche google et r√©cup√©rer les premiers r√©sultats mais cela aurait pris plus de temps pour r√©pondre √† l'utilisateur (et en vrai je voulais essayer Weaviate).</p><p>Gr√¢ce √† cette approche, je peux utiliser n'importe quel LLM sans avoir √† faire de finetuning. Et vu le rythme de parution de nouveaux mod√®les en ce moment, je pourrai aussi remplacer chatGPT par un mod√®le open source dans le futur.</p><h2>La partie o√π je parle technique</h2><p><strong>Tout est sans serveur et scalable</strong>, voici quelques d√©tails techniques :</p><ul><li><p><strong>H√©bergement:</strong> J'utilise GitHub pages pour h√©berger le site web, c'est gratuit tant que la page est statique.</p></li><li><p><strong>API:</strong> L'API est une cloud fonction Google cloud qui ne s'ex√©cute pas quand personne ne l'appelle.</p></li><li><p><strong>Embedding:</strong> J'utilise l'endpoint d'inf√©rence HuggingFace pour les embeddings. C'est tr√®s simple √† mettre en place mais le mod√®le peut prendre un peu de temps √† charger au premier appel. Dans le futur, je pourrais mettre en place un petit service d'embedding CPU.</p></li><li><p><strong>Base de donn√©es:</strong> H√©berg√©e sur Weaviate Cloud, j'utilise leur version gratuite (sandbox) car je n'ai pas les moyens de payer les 25‚Ç¨/mois... mais bon, tant que √ßa marche!</p></li><li><p><strong>LLM:</strong> ChatGPT ! Il y a d'autres mod√®les qui pourraient faire l'affaire mais ChatGPT est bon march√© et simple √† utiliser.</p></li></ul><p>Ce design pens√© pour le cloud peut monter en charge tr√®s facilement (dans les limites de ma carte de cr√©dit) et si personne n'utilise le service, je ne paie pas un seul centime!</p><h1>Sur la place des LLM dans la d√©mocratie</h1><p>Je suis persud√© que nous sommes en train de vivre une r√©volution dans la fa√ßon dont nous interagissons avec les machines. ChatGPT existe depuis un an maintenant et de nombreuses personnes l'ont d√©j√† int√©gr√© dans leur travail quotidien. Cette technologie permet √† tous ceux qui y ont acc√©s d'avoir un expert √† leur c√¥t√©s √† tout moment, ce qui a de profonds impacts sur notre rapport √† l'information.</p><p>Aujourd'hui, le plus grand d√©fi auquel nous sommes confront√©s est d'essayer d'√©loigner les int√©r√™ts financiers des entreprises et de construire un avenir plus ouvert et plus juste o√π cette technologie peut contribuer √† rendre la technologie plus accessible pour le plus grand nombre.</p><p>Avec ce projet, je voulais non seulement aider les gens √† naviguer le droit fran√ßais, mais aussi prouver qu'il y a une place pour l'utilisation d√©mocratique de ces technologies pour aider √† la prise de d√©cision plus √©clair√©e.</p><h1>Comment contribuer ?</h1><p><a href="/blog/assets/img/end.png">xxlarge</a></p><p>L'ensemble du code est opensource et <a href="https://github.com/gouvx">sur GitHub</a>. Si vous voulez participer, n'h√©sitez pas √† faire une pull request ou √† cr√©er une issue. Si ce projet vous semble int√©ressant et que vous souhaitez me contacter, vous pouvez m'envoyer un mail √† <em>ruben.gres@proton.me</em> et je vous r√©pondrai avec plaisir !</p><p>√Ä un futur avec des IA plus utiles ü§ñ</p></div></article></main><footer class="mt-20 px-10 py-8 bg-slate-200"><div class="max-w-5xl mx-auto text-slate-700 text-center">¬© 2023 <a href="/blog/" class="font-medium" target="_blank" rel="noopener">Ruben Gres</a>.</div></footer><script src="/blog/assets/js/bundle.js"></script></body></html>